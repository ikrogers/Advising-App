


<% @courselist = Courselist.all() %>
<% @currentuser = User.find_by_id(session[:user_id]) %>
<% @sql = "SELECT CL.name  FROM courselists CL EXCEPT SELECT C.name FROM courses C where C.studentid = #{@currentuser.id}" %>
<% result = ActiveRecord::Base.connection.raw_connection.prepare(@sql) %>
<% result.execute() %>

<% @filter_course_array = result %>




<% @ccc =  Courselist.all%>


<%= form_tag("/getcourse", :method => "post", :id => "contactForm") do %>
    <%=  select_tag "list", options_for_select(@filter_course_array), :multiple=>true %> <br/>
  </br>
    <%= submit_tag "Send" %>
<% end %>
<div id="result">grgdgdg</div>


<script>

function loop()
	{
		
		var list = document.getElementById('bootstrap-duallistbox-selected-list_list[]');
		var array = "";
		for(var i = 0; i < list.options.length; ++i){
			//if(list.options[i].selected)
				array+=","+list.options[i].value;
				
		}//end for
		 //window.open("localhost:3000//controller/courses."+
		
		return array;
	}


$("#contactForm").submit(function(event) {



	/* stop form from submitting normally */
	event.preventDefault();

	/* clear result div */
	$("#result").html('');
	

	/* get values from elements on the page: */
	var values = loop();
	/* Send the data using post and put the results in a div */
	$.ajax({
		url: "/getcourse",
		type: "post",
		data: {param1:values},
		success: function(data, textStatus, xhr){
		      alert("data: " + values);
		      $("#result").html(data);
		},

		error:function(){
			$("#result").html('there is error while submit');
		}
	});
});
</script>



<script>

 
 
    $(function () {
        $('#list')
                .bootstrapDualListbox({
                    bootstrap2Compatible: false,
                    moveAllLabel: 'MOVE ALL',
                    removeAllLabel: 'REMOVE ALL',
                    moveSelectedLabel: 'MOVE SELECTED',
                    removeSelectedLabel: 'REMOVE SELECTED',
                    filterPlaceHolder: 'FILTER',
                    filterSelected: '2',
                    filterNonSelected: '1',
                    moveOnSelect: true,
                    preserveSelectionOnMove: 'all',
                    helperSelectNamePostfix: '_myhelper',
                    selectedListLabel: 'Your Choices',
                    nonSelectedListLabel: 'Available Classes'
                })
                .bootstrapDualListbox('setMoveAllLabel', 'Choose all')
                .bootstrapDualListbox('setRemoveAllLabel', 'Reset choices')
                .bootstrapDualListbox('setSelectedFilter', undefined)
                .bootstrapDualListbox('setNonSelectedFilter', undefined)
                .bootstrapDualListbox('refresh')
                
    });

          
</script>

<br>
</body>
