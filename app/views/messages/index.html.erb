<%@currentuser = User.find_by_id(session[:user_id])%>
<h1><%=@currentuser.name%>'s Messages</h1>
<table>


  <tbody>
  	<%if(@currentuser.classification == 'Student')%>
    <% (Message.all).each do |message| %>
      <%if(message.from== @currentuser.id)%>
      <div class="modal-content">
      <tr>
        <td><%= "From: #{@currentuser.advisor}  "%></td>
      </tr>
      <tr>
        <td><%= message.content %></td>
      </tr>
      </div>
      <%elsif(message.to == @currentuser.id && message.from == User.find_by_name(@currentuser.advisor).id)%>
      <div class="modal-content">
      <tr>
        <td><%= "To: #{@currentuser.name}  "%></td>
      </tr>
      <tr>
        <td><%= message.content %></td>
      </tr>
      </div>
    <% end %>
    <% end %>
    <%else%>
    <% @messages.each do |message| %>
      <%if(message.to == @currentuser.id)%>
      <div class="modal-content">
      <tr>
        <td><%= "From: #{@currentuser.advisor}  "%></td>
      </tr>
      <tr>
        <td><%= message.content %></td>
      </tr>
      </div>
      <%elsif(message.from == @currentuser.id && message.to == @user.id)%>
      <div class="modal-content">
      <tr>
        <td><%= "To: #{@currentuser.name}  "%></td>
      </tr>
      <tr>
        <td><%= message.content %></td>
      </tr>
      </div>
    <% end %>
    <% end %>
    <% end %>
  </tbody>
</table>

<br>
<div class="btn btn-outline-inverse btn-block">
<%= link_to 'New Message', new_message_path(@user, :id => @user.id) %>
</div>
<%if(@currentuser.classification == 'Student')%>
<div class="btn btn-outline-inverse btn-block">
<%= link_to 'Back', student_path %>
</div>
<%elsif(@currentuser.classification == 'Advisor')%>
<div class="btn btn-outline-inverse btn-block">
<%= link_to 'Back', advisor_path %>
</div>
<%else%>
<div class="btn btn-outline-inverse btn-block">
<%= link_to 'Back', admin_path %>
</div>
<%end%>
